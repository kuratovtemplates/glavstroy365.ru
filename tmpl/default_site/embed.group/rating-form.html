{exp:channel:entries channel="companies"  limit="1" require_entry="yes"}
<div class="modal-header">
  <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
  <h4 class="modal-title" id="myModalLabel">Оценка компании {title}</h4>
</div>



{exp:rating:form
    entry_id="{entry_id}"
    collection="Review"
    return="companies/{segment_3}/thanks"
    form:class="form-registration"
    form:id="idRatingForm1" 
}
<div class="modal-body">
 
    <!-- only show this to guests -->
    {if logged_out}
    <div class="row">
        <div class="col-xs-6">
            <label for="name">Ваше имя</label>
            <div class="form-group">
                <div class="input-group">
                    <input type="text" class="form-control" name="name" id="name" rel="tooltip" data-title="Введите ваше имя">
                    <div class="input-group-addon"><i class="fa fa-user"></i></div>
                </div>
            </div>
        </div>
        <div class="col-xs-6">
            <label for="email">Ваш Email</label>
            <div class="form-group">
                <div class="input-group">
                    <input type="text" class="form-control" name="email" id="email" rel="tooltip" data-title="Введите Ваш Email" >
                    <div class="input-group-addon"><i class="fa fa-envelope-o"></i></div>
                </div>
          </div>
        </div>
    </div>
    {/if}
    <div class="row">
        <div class="col-xs-12">
          <label for="rating">Выставьте рейтинг</label>
          <div class="form-group">
            <div class="input-group" id="rating-stars">
            </div>
          </div>
        </div>
    </div>
    <input type="hidden" name="rating" id="rating" value="">
    <div class="row">
        <div class="col-xs-12">
          <label for="review">Ваш отзыв</label>
          <div class="form-group">
            <textarea class="form-control" name="review" id="review" rows="3"></textarea>
          </div>
        </div>
    </div>
</div>
<div class="modal-footer">
  <button type="button" class="btn btn-default" data-dismiss="modal">Закрыть</button>
  <button type="submit" type="submit"  class="btn btn-success" >Оценить</button>
</div>
{/exp:rating:form}
<script type="text/javascript">
$(document).ready(function() {
    $('#rating-stars').raty({ 
        starType: 'i',
        hints: ['плохо', 'не очень', 'нормально', 'хорошо', 'отлично'],
        target : '#rating',
        targetType : 'score',
        targetKeep : true,
        path: '/raty/images',
         // The name of hidden field generated by Raty
        scoreName: 'star',
        // Re-validate the star rating whenever user change it
        /*
        click: function (score, evt) {
            $('#idRatingForm1')
                .data('bootstrapValidator')             // Return the bootstrapValidator instance
                .updateStatus('star', 'NOT_VALIDATED')  // Mark the star field as not validated yet
                .validateField('star');                 // Validate it again
        }
        */
    });

    $('input[rel="tooltip"]').tooltip({
        'trigger':'focus', 
        'title': $(this).data("title")
    });
    
   
                //Validation
               $('#idRatingForm1').bootstrapValidator({
                    message: 'Данные не верны',
                    excluded: ':disabled',
                  fields: {
                    /*
                    star: {
                        validators: {
                            notEmpty: {
                                message: 'Оцените'
                            }
                        }
                    },*/
                    review: {
                        validators: {
                            notEmpty: {
                                message: 'Введите Ваш отзыв'
                            }                           
                        }
                    },
                    name: {
                        validators: {
                            notEmpty: {
                                message: 'Укажите Ваше имя'
                            }                           
                        }
                    },
                    email: {
                        validators: {
                            notEmpty: {
                                message: 'Укажите email'
                            },
                            emailAddress:{
                              message: 'Не верный формат Email'
                            }
                           
                        }
                    },
                  }
              });
              //End Validation
    
});
</script>
{/exp:channel:entries}